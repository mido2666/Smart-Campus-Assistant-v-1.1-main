# دليل تعديل البيانات - Database Editing Guide

## ⚠️ مهم جداً: كيف تحافظ على تعديلاتك

### المشكلة
عندما تعدل بيانات في Prisma Studio، قد تختفي التعديلات إذا:
- شغلت `npm run db:seed` (يحذف كل البيانات ويعيد إنشائها)
- شغلت `npm run db:reset` (يحذف كل البيانات)
- شغلت `npm run db:clean` (يحذف البيانات)

### الحل: استخدم الأوامر الآمنة

#### ✅ أوامر آمنة (لا تحذف البيانات):
```bash
# فتح Prisma Studio للتعديل
npm run db:studio

# عمل نسخة احتياطية قبل أي تعديل
npm run db:backup

# استخدام seed آمن (لا يحذف البيانات الموجودة)
npm run db:seed:safe
```

#### ❌ أوامر خطيرة (تحذف البيانات):
```bash
# ⚠️ لا تستخدم هذه الأوامر بعد تعديل البيانات:
npm run db:seed        # يحذف كل البيانات!
npm run db:reset       # يحذف كل البيانات!
npm run db:clean       # يحذف البيانات!
```

### خطوات آمنة للتعديل:

1. **عمل نسخة احتياطية أولاً:**
   ```bash
   npm run db:backup
   ```

2. **فتح Prisma Studio:**
   ```bash
   npm run db:studio
   ```

3. **التعديل في Prisma Studio:**
   - عدل البيانات كما تريد
   - احفظ التعديلات

4. **التحقق من التعديلات:**
   - أعد فتح Prisma Studio
   - تأكد أن التعديلات موجودة

### إذا فقدت البيانات:

1. **استعادة من نسخة احتياطية:**
   ```bash
   # ابحث عن ملف backup في مجلد backups/
   # ثم استخدم:
   psql -U postgres -d smart_campus < backups/backup-YYYY-MM-DD.sql
   ```

2. **أو استخدم seed آمن لإعادة البيانات الأساسية:**
   ```bash
   npm run db:seed:safe
   ```

### نصائح مهمة:

1. **دائماً اعمل backup قبل التعديلات الكبيرة**
2. **استخدم `db:seed:safe` بدلاً من `db:seed`**
3. **لا تشغل `db:reset` إلا إذا كنت متأكد 100%**
4. **احتفظ بنسخ احتياطية دورية**

### ملفات النسخ الاحتياطي:

النسخ الاحتياطية تُحفظ في مجلد `backups/` بصيغتين:
- `.sql` - ملف نصي يمكن قراءته
- `.dump` - ملف مضغوط من PostgreSQL

