# ğŸ”§ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ Ø§Ù„Ù…ÙØµÙ„ - ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù€ API Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©

## ğŸ“š Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©-Ø¹Ù„Ù‰-Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯)
2. [ÙƒÙŠÙ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø³ÙŠØ±ÙØ±](#ÙƒÙŠÙ-ÙŠØ¨Ø¯Ø£-Ø§Ù„Ø³ÙŠØ±ÙØ±)
3. [ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù€ API Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù„Ù†Ù‡Ø§ÙŠØ©](#ÙƒÙŠÙ-ÙŠØ¹Ù…Ù„-Ø§Ù„Ù€-api-Ù…Ù†-Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©-Ù„Ù„Ù†Ù‡Ø§ÙŠØ©)
4. [ØªØ¯ÙÙ‚ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…Ù„ (Request Flow)](#ØªØ¯ÙÙ‚-Ø§Ù„Ø·Ù„Ø¨-Ø§Ù„ÙƒØ§Ù…Ù„-request-flow)
5. [Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ: Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ±Ø³ Ø¬Ø¯ÙŠØ¯](#Ù…Ø«Ø§Ù„-Ø¹Ù…Ù„ÙŠ-Ø¥Ù†Ø´Ø§Ø¡-ÙƒÙˆØ±Ø³-Ø¬Ø¯ÙŠØ¯)
6. [Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ: ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„](#Ù…Ø«Ø§Ù„-Ø¹Ù…Ù„ÙŠ-ØªØ³Ø¬ÙŠÙ„-Ø§Ù„Ø¯Ø®ÙˆÙ„)
7. [ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Authentication)](#ÙƒÙŠÙ-ØªØ¹Ù…Ù„-Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©-authentication)
8. [ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Prisma](#ÙƒÙŠÙ-ØªØ¹Ù…Ù„-Ù‚Ø§Ø¹Ø¯Ø©-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª-Ù…Ø¹-prisma)
9. [Middleware ÙˆÙƒÙŠÙ ØªØ¹Ù…Ù„](#middleware-ÙˆÙƒÙŠÙ-ØªØ¹Ù…Ù„)
10. [Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡](#Ø¥Ø¯Ø§Ø±Ø©-Ø§Ù„Ø£Ø®Ø·Ø§Ø¡)

---

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯

### Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ØŸ

Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ Ù‡Ùˆ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø°ÙŠ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙˆÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹:

- âœ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù† Frontend
- âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- âœ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- âœ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ÙˆØ¯ Ù„Ù„Ù€ Frontend

### Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

```
Frontend (React)
    â†“ HTTP Request
Backend (Express.js)
    â†“ Prisma ORM
Database (PostgreSQL)
    â†“ Response
Backend
    â†“ JSON Response
Frontend
```

---

## ÙƒÙŠÙ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø³ÙŠØ±ÙØ±

### 1. Ù…Ù„Ù Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©: `server/index.ts`

Ø¹Ù†Ø¯ ØªØ´ØºÙŠÙ„ `npm run server:dev`ØŒ ÙŠØ­Ø¯Ø« Ø§Ù„ØªØ§Ù„ÙŠ:

```typescript
// 1. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
import express from "express";
import cors from "cors";
import dotenv from "dotenv";

// 2. ØªØ­Ù…ÙŠÙ„ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© Ù…Ù† Ù…Ù„Ù .env
dotenv.config();

// 3. Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Express
const app = express();

// 4. ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù†ÙØ° (Port)
const PORT = process.env.PORT || 3001;
```

### 2. Ø¥Ø¹Ø¯Ø§Ø¯ Middleware

```typescript
// Middleware Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø·Ù„Ø¨Ø§Øª Ù…Ù† Frontend (CORS)
app.use(
  cors({
    origin: process.env.ALLOWED_ORIGINS.split(","),
    credentials: true,
  })
);

// Middleware Ù„Ù‚Ø±Ø§Ø¡Ø© JSON Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª
app.use(express.json({ limit: "10mb" }));

// Middleware Ù„Ù‚Ø±Ø§Ø¡Ø© URL-encoded data
app.use(express.urlencoded({ extended: true }));

// Middleware Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Logging)
app.use(morgan("dev"));
```

### 3. ØªØ³Ø¬ÙŠÙ„ Routes

```typescript
// ØªØ³Ø¬ÙŠÙ„ routes Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©
app.use("/api/auth", authRouter);

// ØªØ³Ø¬ÙŠÙ„ routes Ù„Ù„ÙƒÙˆØ±Ø³Ø§Øª
app.use("/api/courses", courseRouter);

// ØªØ³Ø¬ÙŠÙ„ routes Ù„Ù„Ø­Ø¶ÙˆØ±
app.use("/api/attendance", attendanceRouter);
```

### 4. Ø¨Ø¯Ø¡ Ø§Ù„Ø³ÙŠØ±ÙØ±

```typescript
// Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ°
httpServer.listen(PORT, "0.0.0.0", () => {
  console.log(`ğŸš€ Server listening on http://0.0.0.0:${PORT}`);
});
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø©**: Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø¢Ù† ÙŠØ³ØªÙ…Ø¹ Ø¹Ù„Ù‰ `http://localhost:3001` ÙˆØ¬Ø§Ù‡Ø² Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª!

---

## ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù€ API Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù„Ù†Ù‡Ø§ÙŠØ©

### Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ API

```
1. Frontend ÙŠØ±Ø³Ù„ Request
   â†“
2. Express ÙŠØ³ØªÙ‚Ø¨Ù„ Request
   â†“
3. Middleware ÙŠØ¹Ø§Ù„Ø¬ Request
   (CORS, Body Parser, Auth)
   â†“
4. Route Handler ÙŠØ³ØªÙ‚Ø¨Ù„ Request
   â†“
5. Controller ÙŠØ¹Ø§Ù„Ø¬ Request
   â†“
6. Service ÙŠÙ†ÙØ° Ø§Ù„Ù…Ù†Ø·Ù‚
   â†“
7. Prisma ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Database
   â†“
8. Service ÙŠØ±Ø¬Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
   â†“
9. Controller ÙŠØ±Ø¬Ø¹ Response
   â†“
10. Express ÙŠØ±Ø³Ù„ Response
   â†“
11. Frontend ÙŠØ³ØªÙ‚Ø¨Ù„ Response
```

---

## ØªØ¯ÙÙ‚ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…Ù„ (Request Flow)

### Ù…Ø«Ø§Ù„: GET `/api/courses`

Ø¯Ø¹Ù†Ø§ Ù†ØªØ¨Ø¹ Ø·Ù„Ø¨ Ù…Ù† Frontend Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª:

#### Ø§Ù„Ø®Ø·ÙˆØ© 1: Frontend ÙŠØ±Ø³Ù„ Request

```typescript
// ÙÙŠ Frontend (React)
const response = await apiClient.get("/api/courses", {
  headers: {
    Authorization: `Bearer ${accessToken}`,
  },
});
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Frontend ÙŠØ±Ø³Ù„ HTTP GET request Ø¥Ù„Ù‰ `http://localhost:3001/api/courses`
- ÙŠØ¶ÙŠÙ Header Ù„Ù„Ù€ Authorization Ù…Ø¹ JWT token

#### Ø§Ù„Ø®Ø·ÙˆØ© 2: Express ÙŠØ³ØªÙ‚Ø¨Ù„ Request

```typescript
// server/index.ts
app.use("/api/courses", courseRouter);
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Express ÙŠØ³ØªÙ‚Ø¨Ù„ Request Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± `/api/courses`
- ÙŠØ¨Ø­Ø« Ø¹Ù† Route Ù…Ø·Ø§Ø¨Ù‚ ÙÙŠ `courseRouter`

#### Ø§Ù„Ø®Ø·ÙˆØ© 3: Route Handler

```typescript
// src/routes/course.routes.ts
router.get("/", CourseController.getAllCourses);
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Route handler ÙŠØ¬Ø¯ Ø§Ù„Ù…Ø³Ø§Ø± `/` (ÙŠØ¹Ù†ÙŠ `/api/courses`)
- ÙŠØ³ØªØ¯Ø¹ÙŠ `CourseController.getAllCourses`

#### Ø§Ù„Ø®Ø·ÙˆØ© 4: Auth Middleware

```typescript
// src/routes/course.routes.ts
router.use(AuthMiddleware.authenticate());
```

**Ù…Ø§ ÙŠØ­Ø¯Ø« Ù‚Ø¨Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù€ Controller**:

1. Auth Middleware ÙŠØªØ­Ù‚Ù‚ Ù…Ù† JWT token
2. Ø¥Ø°Ø§ ÙƒØ§Ù† Token ØµØ§Ù„Ø­ØŒ ÙŠØ¶ÙŠÙ `req.user` Ø¥Ù„Ù‰ Request
3. Ø¥Ø°Ø§ ÙƒØ§Ù† Token ØºÙŠØ± ØµØ§Ù„Ø­ØŒ ÙŠØ±Ø³Ù„ 401 Unauthorized

```typescript
// src/middleware/auth.middleware.ts
static authenticate() {
  return async (req, res, next) => {
    // 1. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Token Ù…Ù† Header
    const token = req.headers.authorization?.split(' ')[1];

    // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Token
    const payload = JWTUtils.verifyAccessToken(token);

    // 3. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Database
    const user = await AuthService.getUserById(payload.userId);

    // 4. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Request
    req.user = user;

    // 5. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
    next();
  };
}
```

#### Ø§Ù„Ø®Ø·ÙˆØ© 5: Controller

```typescript
// src/controllers/course.controller.ts
static async getAllCourses(req: Request, res: Response): Promise<void> {
  try {
    // 1. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Query Parameters (Ù…Ø«Ù„ professorId)
    const { professorId, isActive } = req.query;

    // 2. Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Service Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const courses = await CourseService.getAllCourses({
      professorId: professorId ? parseInt(professorId as string) : undefined,
      isActive: isActive === 'true' ? true : undefined
    });

    // 3. Ø¥Ø±Ø³Ø§Ù„ Response
    res.status(200).json({
      success: true,
      data: courses
    });
  } catch (error) {
    // 4. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
}
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Controller ÙŠØ³ØªÙ‚Ø¨Ù„ Request Ù…Ø¹ `req.user` (Ù…Ù† Auth Middleware)
- ÙŠØ³ØªØ®Ø±Ø¬ Query Parameters
- ÙŠØ³ØªØ¯Ø¹ÙŠ Service Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠØ±Ø³Ù„ Response

#### Ø§Ù„Ø®Ø·ÙˆØ© 6: Service

```typescript
// src/services/course.service.ts
static async getAllCourses(filters?: {
  professorId?: number;
  isActive?: boolean;
}): Promise<Course[]> {
  // 1. Ø¨Ù†Ø§Ø¡ Where Clause Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…
  const where: any = {};

  if (filters?.professorId) {
    where.professorId = filters.professorId;
  }

  if (filters?.isActive !== undefined) {
    where.isActive = filters.isActive;
  }

  // 2. Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Prisma
  const courses = await prisma.course.findMany({
    where,
    include: {
      professor: {
        select: {
          id: true,
          firstName: true,
          lastName: true
        }
      },
      enrollments: {
        where: { status: 'ACTIVE' },
        include: {
          student: true
        }
      },
      schedules: {
        where: { isActive: true }
      }
    },
    orderBy: {
      courseCode: 'asc'
    }
  });

  // 3. Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
  return courses;
}
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Service ÙŠØ¨Ù†ÙŠ Ø§Ø³ØªØ¹Ù„Ø§Ù… Prisma
- ÙŠØ³ØªØ¹Ù„Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠØ±Ø¬Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

#### Ø§Ù„Ø®Ø·ÙˆØ© 7: Prisma ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Database

```typescript
// Prisma ÙŠØªØ±Ø¬Ù… Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ SQL
// Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙŠØªØ±Ø¬Ù… Ø¥Ù„Ù‰:

SELECT
  c.*,
  u.id as professor_id,
  u.firstName as professor_firstName,
  u.lastName as professor_lastName,
  ...
FROM courses c
LEFT JOIN users u ON c.professorId = u.id
LEFT JOIN course_enrollments e ON c.id = e.courseId
WHERE c.professorId = ? AND c.isActive = ?
ORDER BY c.courseCode ASC
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Prisma ÙŠØªØ±Ø¬Ù… JavaScript Ø¥Ù„Ù‰ SQL
- PostgreSQL ÙŠÙ†ÙØ° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…
- ÙŠØ±Ø¬Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

#### Ø§Ù„Ø®Ø·ÙˆØ© 8: Response ÙŠØ¹ÙˆØ¯ Ù„Ù„Ù€ Frontend

```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "courseCode": "CS101",
      "courseName": "Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨",
      "professor": {
        "id": 1,
        "firstName": "Ø£Ø­Ù…Ø¯",
        "lastName": "Ø§Ù„Ø³ÙŠØ¯"
      },
      "enrollments": [...],
      "schedules": [...]
    }
  ]
}
```

---

## Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ: Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ±Ø³ Ø¬Ø¯ÙŠØ¯

Ø¯Ø¹Ù†Ø§ Ù†ØªØ¨Ø¹ Ø·Ù„Ø¨ Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ±Ø³ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù„Ù†Ù‡Ø§ÙŠØ©:

### Ø§Ù„Ø®Ø·ÙˆØ© 1: Frontend ÙŠØ±Ø³Ù„ Request

```typescript
// ÙÙŠ Frontend
const response = await apiClient.post(
  "/api/courses",
  {
    courseCode: "CS101",
    courseName: "Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨",
    description: "ÙƒÙˆØ±Ø³ ØªÙ…Ù‡ÙŠØ¯ÙŠ",
    credits: 3,
  },
  {
    headers: {
      Authorization: `Bearer ${accessToken}`,
    },
  }
);
```

**HTTP Request**:

```
POST /api/courses HTTP/1.1
Host: localhost:3001
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  "courseCode": "CS101",
  "courseName": "Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨",
  "description": "ÙƒÙˆØ±Ø³ ØªÙ…Ù‡ÙŠØ¯ÙŠ",
  "credits": 3
}
```

### Ø§Ù„Ø®Ø·ÙˆØ© 2: Route Handler

```typescript
// src/routes/course.routes.ts

// 1. ØªØ·Ø¨ÙŠÙ‚ Auth Middleware Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Routes
router.use(AuthMiddleware.authenticate());

// 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Role (PROFESSOR Ø£Ùˆ ADMIN ÙÙ‚Ø·)
const requireProfessorOrAdmin = (req, res, next) => {
  if (req.user.role !== "PROFESSOR" && req.user.role !== "ADMIN") {
    return res.status(403).json({
      success: false,
      message: "Access denied. Professor or Admin role required.",
    });
  }
  next();
};

// 3. Route Handler
router.post("/", requireProfessorOrAdmin, CourseController.createCourse);
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

1. Auth Middleware ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Token
2. ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… PROFESSOR Ø£Ùˆ ADMIN
3. ÙŠØ³ØªØ¯Ø¹ÙŠ Controller

### Ø§Ù„Ø®Ø·ÙˆØ© 3: Controller

```typescript
// src/controllers/course.controller.ts
static async createCourse(req: any, res: Response): Promise<void> {
  try {
    // 1. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Request Body
    const { courseCode, courseName, description, credits } = req.body;

    // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
    if (!courseCode || !courseName) {
      return res.status(400).json({
        success: false,
        message: 'Course code and course name are required'
      });
    }

    // 3. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ professorId Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚ Ø¹Ù„ÙŠÙ‡
    const professorId = req.user.id;

    // 4. Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Service Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒÙˆØ±Ø³
    const course = await CourseService.createCourse({
      courseCode,
      courseName,
      description: description || '',
      credits: credits || 3,
      professorId: typeof professorId === 'string' ? parseInt(professorId) : professorId
    });

    // 5. Ø¥Ø±Ø³Ø§Ù„ Response
    res.status(201).json({
      success: true,
      message: 'Course created successfully',
      data: course
    });
  } catch (error: any) {
    // 6. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    console.error('Error creating course:', error);
    res.status(500).json({
      success: false,
      message: error.message || 'Failed to create course'
    });
  }
}
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Controller ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠØ³ØªØ¯Ø¹ÙŠ Service

### Ø§Ù„Ø®Ø·ÙˆØ© 4: Service

```typescript
// src/services/course.service.ts
static async createCourse(data: CreateCourseData): Promise<Course> {
  try {
    // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø³ØªØ§Ø°
    const professor = await prisma.user.findUnique({
      where: { id: data.professorId }
    });

    if (!professor || (professor.role !== 'PROFESSOR' && professor.role !== 'ADMIN')) {
      throw new Error('User is not authorized to create courses');
    }

    // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ ÙƒÙˆØ±Ø³ Ø¨Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯
    const existingCourse = await prisma.course.findUnique({
      where: { courseCode: data.courseCode }
    });

    if (existingCourse) {
      throw new Error('Course with this code already exists');
    }

    // 3. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒÙˆØ±Ø³ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const course = await prisma.course.create({
      data: {
        courseCode: data.courseCode,
        courseName: data.courseName,
        description: data.description,
        credits: data.credits || 3,
        professorId: data.professorId,
        isActive: true
      },
      include: {
        professor: {
          select: {
            id: true,
            firstName: true,
            lastName: true,
            email: true
          }
        },
        enrollments: true,
        schedules: true
      }
    });

    // 4. Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„ÙƒÙˆØ±Ø³ Ø§Ù„Ù…Ù†Ø´Ø£
    return course;
  } catch (error) {
    throw error;
  }
}
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Service ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
- ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠÙ†Ø´Ø¦ Ø§Ù„ÙƒÙˆØ±Ø³ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠØ±Ø¬Ø¹ Ø§Ù„ÙƒÙˆØ±Ø³ Ø§Ù„Ù…Ù†Ø´Ø£

### Ø§Ù„Ø®Ø·ÙˆØ© 5: Prisma ÙŠÙ†ÙØ° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…

```typescript
// Prisma ÙŠØªØ±Ø¬Ù… Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ SQL:

INSERT INTO courses (
  "courseCode",
  "courseName",
  "description",
  "credits",
  "professorId",
  "isActive",
  "createdAt",
  "updatedAt"
) VALUES (
  'CS101',
  'Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨',
  'ÙƒÙˆØ±Ø³ ØªÙ…Ù‡ÙŠØ¯ÙŠ',
  3,
  1,
  true,
  NOW(),
  NOW()
) RETURNING *;
```

### Ø§Ù„Ø®Ø·ÙˆØ© 6: Response

```json
{
  "success": true,
  "message": "Course created successfully",
  "data": {
    "id": 1,
    "courseCode": "CS101",
    "courseName": "Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨",
    "description": "ÙƒÙˆØ±Ø³ ØªÙ…Ù‡ÙŠØ¯ÙŠ",
    "credits": 3,
    "professorId": 1,
    "isActive": true,
    "createdAt": "2025-01-01T10:00:00.000Z",
    "professor": {
      "id": 1,
      "firstName": "Ø£Ø­Ù…Ø¯",
      "lastName": "Ø§Ù„Ø³ÙŠØ¯"
    }
  }
}
```

---

## Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ: ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„

### Ø§Ù„Ø®Ø·ÙˆØ© 1: Frontend ÙŠØ±Ø³Ù„ Request

```typescript
// Frontend
const response = await apiClient.post("/api/auth/login", {
  universityId: "12345678",
  password: "123456",
});
```

### Ø§Ù„Ø®Ø·ÙˆØ© 2: Route Handler

```typescript
// src/routes/auth.routes.ts
authRouter.post("/login", loginRateLimit, AuthController.login);
```

**Ù…Ù„Ø§Ø­Ø¸Ø©**: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Auth Middleware Ù‡Ù†Ø§ Ù„Ø£Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ endpoint Ø¹Ø§Ù… (public)

### Ø§Ù„Ø®Ø·ÙˆØ© 3: Controller

```typescript
// src/controllers/auth.controller.ts
static async login(req: Request, res: Response): Promise<void> {
  try {
    // 1. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const { universityId, password } = req.body;

    // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    if (!universityId || !password) {
      return res.status(400).json({
        success: false,
        message: 'University ID and password are required'
      });
    }

    // 3. Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Service
    const result = await AuthService.login({
      universityId,
      password
    });

    // 4. Ø¥Ø±Ø³Ø§Ù„ Response
    res.status(200).json({
      success: true,
      message: 'Login successful',
      data: result
    });
  } catch (error: any) {
    res.status(401).json({
      success: false,
      message: error.message || 'Invalid credentials'
    });
  }
}
```

### Ø§Ù„Ø®Ø·ÙˆØ© 4: Service

```typescript
// src/services/auth.service.ts
static async login(data: LoginRequest): Promise<AuthResponse> {
  // 1. Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  const user = await prisma.user.findUnique({
    where: { universityId: data.universityId }
  });

  if (!user) {
    throw new Error('Invalid credentials');
  }

  // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
  const isValid = await bcrypt.compare(data.password, user.password);
  if (!isValid) {
    throw new Error('Invalid credentials');
  }

  // 3. Ø¥Ù†Ø´Ø§Ø¡ Access Token
  const accessToken = JWTUtils.generateAccessToken({
    userId: user.id.toString(),
    role: user.role.toLowerCase()
  });

  // 4. Ø¥Ù†Ø´Ø§Ø¡ Refresh Token
  const refreshToken = JWTUtils.generateRefreshToken({
    userId: user.id.toString(),
    tokenVersion: user.tokenVersion
  });

  // 5. Ø­ÙØ¸ Refresh Token ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  await prisma.refreshToken.create({
    data: {
      token: refreshToken,
      userId: user.id,
      expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000) // 7 days
    }
  });

  // 6. Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  return {
    user: {
      id: user.id.toString(),
      universityId: user.universityId,
      email: user.email,
      firstName: user.firstName,
      lastName: user.lastName,
      role: user.role.toLowerCase()
    },
    accessToken,
    refreshToken,
    expiresIn: 15 * 60 // 15 minutes in seconds
  };
}
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

1. Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… bcrypt
3. Ø¥Ù†Ø´Ø§Ø¡ JWT tokens
4. Ø­ÙØ¸ Refresh Token
5. Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù†ØªÙŠØ¬Ø©

### Ø§Ù„Ø®Ø·ÙˆØ© 5: Response

```json
{
  "success": true,
  "message": "Login successful",
  "data": {
    "user": {
      "id": "1",
      "universityId": "12345678",
      "email": "student@university.edu",
      "firstName": "Ø£Ø­Ù…Ø¯",
      "lastName": "Ù…Ø­Ù…Ø¯",
      "role": "student"
    },
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expiresIn": 900
  }
}
```

---

## ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Authentication)

### 1. Ø¥Ù†Ø´Ø§Ø¡ JWT Token

```typescript
// src/utils/jwt.ts
static generateAccessToken(payload: JWTPayload): string {
  return jwt.sign(
    {
      userId: payload.userId,
      role: payload.role
    },
    process.env.JWT_SECRET,
    {
      expiresIn: '15m', // 15 Ø¯Ù‚ÙŠÙ‚Ø©
      issuer: 'smart-campus-assistant',
      audience: 'smart-campus-users'
    }
  );
}
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- JWT ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰: `userId`, `role`, `exp` (expiration time)
- Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… `JWT_SECRET`
- Ù…Ø¯Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: 15 Ø¯Ù‚ÙŠÙ‚Ø©

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† JWT Token

```typescript
// src/utils/jwt.ts
static verifyAccessToken(token: string): JWTPayload {
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET) as JWTPayload;
    return decoded;
  } catch (error) {
    if (error.name === 'TokenExpiredError') {
      throw new Error('Token expired');
    }
    throw new Error('Invalid token');
  }
}
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (payload)

### 3. Auth Middleware

```typescript
// src/middleware/auth.middleware.ts
static authenticate() {
  return async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {
    try {
      // 1. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Token Ù…Ù† Header
      const authHeader = req.headers.authorization;
      if (!authHeader || !authHeader.startsWith('Bearer ')) {
        return res.status(401).json({
          success: false,
          message: 'Access token is required'
        });
      }

      const token = authHeader.substring(7); // Ø¥Ø²Ø§Ù„Ø© "Bearer "

      // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Token
      const payload = JWTUtils.verifyAccessToken(token);

      // 3. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      const user = await AuthService.getUserById(payload.userId);
      if (!user) {
        return res.status(401).json({
          success: false,
          message: 'User not found'
        });
      }

      // 4. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Request
      req.user = user;

      // 5. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
      next();
    } catch (error) {
      res.status(401).json({
        success: false,
        message: 'Invalid or expired token'
      });
    }
  };
}
```

---

## ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Prisma

### 1. Prisma Client

```typescript
// config/database.ts
import { PrismaClient } from "../src/generated/prisma";

const prisma = new PrismaClient({
  log: process.env.NODE_ENV === "development" ? ["query", "error"] : ["error"],
});

export default prisma;
```

### 2. Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª Prisma

#### Create (Ø¥Ù†Ø´Ø§Ø¡)

```typescript
const course = await prisma.course.create({
  data: {
    courseCode: "CS101",
    courseName: "Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨",
    professorId: 1,
  },
});
```

**SQL Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„**:

```sql
INSERT INTO courses (courseCode, courseName, professorId)
VALUES ('CS101', 'Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨', 1)
RETURNING *;
```

#### Read (Ù‚Ø±Ø§Ø¡Ø©)

```typescript
// Find Unique (Ø¨Ø­Ø« Ø¹Ù† ÙˆØ§Ø­Ø¯)
const course = await prisma.course.findUnique({
  where: { id: 1 },
});

// Find Many (Ø¨Ø­Ø« Ø¹Ù† Ø¹Ø¯Ø©)
const courses = await prisma.course.findMany({
  where: { isActive: true },
});
```

**SQL Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„**:

```sql
SELECT * FROM courses WHERE id = 1;
SELECT * FROM courses WHERE isActive = true;
```

#### Update (ØªØ­Ø¯ÙŠØ«)

```typescript
const course = await prisma.course.update({
  where: { id: 1 },
  data: {
    courseName: "Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨ (Ù…Ø­Ø¯Ø«)",
  },
});
```

**SQL Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„**:

```sql
UPDATE courses
SET courseName = 'Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨ (Ù…Ø­Ø¯Ø«)'
WHERE id = 1
RETURNING *;
```

#### Delete (Ø­Ø°Ù)

```typescript
// Hard Delete
await prisma.course.delete({
  where: { id: 1 },
});

// Soft Delete (Ø§Ù„Ø£ÙØ¶Ù„)
await prisma.course.update({
  where: { id: 1 },
  data: { isActive: false },
});
```

### 3. Relations (Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª)

```typescript
// Include Relations
const course = await prisma.course.findUnique({
  where: { id: 1 },
  include: {
    professor: true, // Ø¥Ø­Ø¶Ø§Ø± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³ØªØ§Ø°
    enrollments: {
      include: {
        student: true, // Ø¥Ø­Ø¶Ø§Ø± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨
      },
    },
  },
});
```

**SQL Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„**:

```sql
SELECT
  c.*,
  u.* as professor,
  e.* as enrollments,
  s.* as student
FROM courses c
LEFT JOIN users u ON c.professorId = u.id
LEFT JOIN course_enrollments e ON c.id = e.courseId
LEFT JOIN users s ON e.studentId = s.id
WHERE c.id = 1;
```

---

## Middleware ÙˆÙƒÙŠÙ ØªØ¹Ù…Ù„

### 1. CORS Middleware

```typescript
app.use(
  cors({
    origin: process.env.ALLOWED_ORIGINS.split(","),
    credentials: true,
  })
);
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- ÙŠØ¶ÙŠÙ Headers Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø·Ù„Ø¨Ø§Øª Ù…Ù† Frontend
- ÙŠØ³Ù…Ø­ Ø¨Ø¥Ø±Ø³Ø§Ù„ Cookies (credentials)

**Headers Ø§Ù„Ù…Ø¶Ø§ÙØ©**:

```
Access-Control-Allow-Origin: http://localhost:5173
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: GET, POST, PUT, DELETE
```

### 2. Body Parser Middleware

```typescript
app.use(express.json({ limit: "10mb" }));
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- ÙŠØ­ÙˆÙ„ JSON body Ø¥Ù„Ù‰ JavaScript object
- ÙŠØ¶ÙŠÙÙ‡ Ø¥Ù„Ù‰ `req.body`

**Ù…Ø«Ø§Ù„**:

```json
// Request Body
{
  "courseCode": "CS101"
}

// ÙŠØµØ¨Ø­ ÙÙŠ req.body
req.body = {
  courseCode: "CS101"
}
```

### 3. Auth Middleware

Ø±Ø§Ø¬Ø¹ Ù‚Ø³Ù… [ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©](#ÙƒÙŠÙ-ØªØ¹Ù…Ù„-Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©-authentication)

### 4. Error Handler Middleware

```typescript
app.use((error, req, res, next) => {
  console.error("Global error handler:", error);

  res.status(error.status || 500).json({
    success: false,
    message: error.message || "Internal server error",
    ...(process.env.NODE_ENV === "development" && { stack: error.stack }),
  });
});
```

**Ù…Ø§ ÙŠØ­Ø¯Ø«**:

- ÙŠÙ„ØªÙ‚Ø· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
- ÙŠØ±Ø³Ù„ Response Ù…Ù†Ø§Ø³Ø¨
- ÙÙŠ DevelopmentØŒ ÙŠØ±Ø³Ù„ stack trace

---

## Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### 1. Errors ÙÙŠ Controller

```typescript
try {
  const course = await CourseService.createCourse(data);
  res.status(201).json({
    success: true,
    data: course,
  });
} catch (error) {
  // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø®Ø·Ø£
  res.status(500).json({
    success: false,
    message: error.message,
  });
}
```

### 2. Errors ÙÙŠ Service

```typescript
static async createCourse(data: CreateCourseData) {
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  if (!data.courseCode) {
    throw new Error('Course code is required');
  }

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
  const user = await prisma.user.findUnique({
    where: { id: data.professorId }
  });

  if (!user || user.role !== 'PROFESSOR') {
    throw new Error('User is not authorized');
  }

  // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒÙˆØ±Ø³
  return await prisma.course.create({ data });
}
```

### 3. Global Error Handler

```typescript
app.use((error, req, res, next) => {
  console.error("Error:", error);

  // Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
  if (error.name === "JsonWebTokenError") {
    return res.status(401).json({
      success: false,
      message: "Invalid token",
    });
  }

  // Ø®Ø·Ø£ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  if (error.code === "P2002") {
    return res.status(400).json({
      success: false,
      message: "Duplicate entry",
    });
  }

  // Ø®Ø·Ø£ Ø¹Ø§Ù…
  res.status(500).json({
    success: false,
    message: error.message || "Internal server error",
  });
});
```

---

## Ù…Ù„Ø®Øµ

### Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„

1. **Frontend** â†’ ÙŠØ±Ø³Ù„ HTTP Request
2. **Express** â†’ ÙŠØ³ØªÙ‚Ø¨Ù„ Request
3. **Middleware** â†’ ÙŠØ¹Ø§Ù„Ø¬ Request (CORS, Auth, Body Parser)
4. **Route** â†’ ÙŠÙˆØ¬Ù‡ Request Ù„Ù„Ù€ Controller Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
5. **Controller** â†’ ÙŠØ³ØªØ¯Ø¹ÙŠ Service
6. **Service** â†’ ÙŠÙ†ÙØ° Ø§Ù„Ù…Ù†Ø·Ù‚ ÙˆÙŠØ³ØªØ¹Ù„Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
7. **Prisma** â†’ ÙŠØªØ±Ø¬Ù… Ø¥Ù„Ù‰ SQL ÙˆÙŠÙ†ÙØ° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…
8. **Database** â†’ ÙŠØ±Ø¬Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
9. **Service** â†’ ÙŠØ±Ø¬Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù€ Controller
10. **Controller** â†’ ÙŠØ±Ø³Ù„ Response
11. **Express** â†’ ÙŠØ±Ø³Ù„ HTTP Response
12. **Frontend** â†’ ÙŠØ³ØªÙ‚Ø¨Ù„ Response

### Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

- **Express**: Ø¥Ø·Ø§Ø± Ø¹Ù…Ù„ Ø§Ù„ÙˆÙŠØ¨
- **Routes**: ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
- **Controllers**: Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
- **Services**: Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ
- **Prisma**: ORM Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- **Middleware**: Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‚Ø¨Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù€ Routes
- **JWT**: Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
- **Bcrypt**: ØªØ´ÙÙŠØ± ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«**: ÙŠÙ†Ø§ÙŠØ± 2025
